function Mapsforge(){this.mapmodule=require("ti.mapsforge"),this.navimodule=this.mapmodule,this.myLocMarker=0,this.myLocCircle=0,this.type=1}Mapsforge.prototype=new Map,Mapsforge.prototype.initWindowEvent=function(){var e=this;this.win.addEventListener("focus",function(){views.createPlaceView(),views.createSearchList(),views.hideBar()}),Ti.App.addEventListener("viewCreated",function(i){Ti.API.info("mapCreated: received by js"),e.addOfflineMapLayer(),views.createAndroidSearchBar(),e.initGPS(),places.showAllSavedPlaceMarkers(),places.createSavedPlaceTable()}),Ti.App.addEventListener("clicked",function(i){var t=[i.lat,i.lng],o=places.findSavedMarker(t);null!==o&&e.changeDestination([o.lat,o.lng]),views.hideSearchList(),views.hideKeyboard()}),Ti.App.addEventListener("longclicked",function(i){var t=[i.lat,i.lng];Ti.API.info("longclicked:"+t),e.changeDestination(t)})},Mapsforge.prototype.init=function(){var e=Ti.App.Properties.getDouble("gps_lng",0),i=Ti.App.Properties.getDouble("gps_lat",0);this.mapView=this.mapmodule.createMapsforgeView({scalebar:!0,minZoom:5,maxZoom:20,centerLatlng:[i,e],zoomLevel:16,debug:!1}),this.win.add(this.mapView),this.win.open(),this.initWindowEvent(),this.initNav()},Mapsforge.prototype.move=function(e){this.mapView.centerLatlng=e},Mapsforge.prototype.animateTo=function(e){this.mapView.animateTo(e)},Mapsforge.prototype.addOfflineMapLayer=function(){this.mapView.addLayer({name:"osm",path:Ti.App.id+"/map/nz.map"})},Mapsforge.prototype.addPolyline=function(e,i,t){return this.mapView.createPolyline({latlngs:e,color:i,strokeWidth:t})},Mapsforge.prototype.addMarker=function(e,i){var t=this.mapView.createMarker({iconPath:i,latlng:e});return t},Mapsforge.prototype.removeMarker=function(e){this.mapView.removeLayer(e)},Mapsforge.prototype.removePolyline=function(e){this.mapView.removeLayer(e)},Mapsforge.prototype.removeLayer=function(e){this.mapView.removeLayer(e)},Mapsforge.prototype.addCircle=function(e,i,t){var o=this.mapView.createCircle({radius:i,latlng:e,colorHex:t});return o},Mapsforge.prototype.updateCircle=function(e,i,t){this.mapView.updateLayer({id:e,type:"circle",latlng:i,radius:t,move:1})},Mapsforge.prototype.updateMarker=function(e,i){this.mapView.updateLayer({id:e,type:"marker",latlng:i,move:1})},Mapsforge.prototype.changeDestination=function(e){views.hidePopView(),this.destination=e,0!==this.dest_marker&&this.mapView.removeLayer(this.dest_marker);var i=Ti.App.Android.R.drawable.marker_tap_long,t=this.addMarker(e,i);this.dest_marker=t,views.showPopView(e)},Mapsforge.prototype.addMyLocMarker=function(e,i){0!==this.myLocCircle||0!==this.myLocMarker?(this.updateCircle(this.myLocCircle,e,i),this.updateMarker(this.myLocMarker,e)):(this.myLocCircle=this.addCircle(e,i,"#33000099"),this.myLocMarker=this.addMarker(e,Ti.App.Android.R.drawable.me_point_blue_1))};