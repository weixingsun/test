function initWindowEvent(e){e.addEventListener("focus",function(){hideBar(e);var i=createPlaceView();Ti.App.Properties.setObject("pop",i)})}function hideBar(e){var i=e.activity.actionBar;"undefined"!=typeof i&&i.hide()}function initWindow(){return Ti.UI.createWindow()}function initMapsfirgeModule(){return require("ti.mapsforge")}function initMapsforge(e,i){var a=Ti.App.Properties.getDouble("gps_lng",0),t=Ti.App.Properties.getDouble("gps_lat",0),n=i.createMapsforgeView({scalebar:!0,minZoom:5,maxZoom:20,centerLatlng:[t,a],zoomLevel:16,debug:!1});return e.add(n),e.open(),n}function move(e){map.centerLatlng=e}function animateTo(e){map.animateTo(e)}function addOfflineMapLayer(e){e.addLayer({name:"osm",path:Ti.App.id+"/map/nz.map"})}function initMapListener(e,i,a){Ti.App.addEventListener("viewCreated",function(){Ti.API.info("mapCreated: received by js"),addOfflineMapLayer(a),createAndroidSearchBar(),addActionListenersMF(i,a),appEventListeners(),initGPS(),showAllSavedPlaceMarkers(),createSavedPlaceTable()})}function addPolylineMF(e,i,a){return map.createPolyline({latlngs:e,color:i,strokeWidth:a})}function addMarkerMF(e,i){var a=map.createMarker({iconPath:i,latlng:e});return Ti.API.info("addMarkerMF()"+JSON.stringify(a)),a}function addCircleMF(e,i,a){var t=map.createCircle({radius:i,latlng:e,colorHex:a});return t}function removeLayer(e){map.removeLayer(e)}function updateCircle(e,i,a){map.updateLayer({id:e,type:"circle",latlng:i,radius:a,move:1})}function updateMarker(e,i){map.updateLayer({id:e,type:"marker",latlng:i,move:1})}initVars("mapsforge.offline"),importUtteranceModule();var win=initWindow();initWindowEvent(win);var navimodule=initMapsfirgeModule(),map=initMapsforge(win,navimodule);initMapListener(win,navimodule,map),initNav(navimodule);