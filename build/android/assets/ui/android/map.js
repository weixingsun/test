function initWindowEvent(e){e.addEventListener("focus",function(){hideBar(e);var i=createPlaceView();Ti.App.Properties.setObject("pop",i)})}function hideBar(e){var i=e.activity.actionBar;"undefined"!=typeof i&&i.hide()}function initWindow(){return Ti.UI.createWindow()}function initModule(){return require("ti.mapsforge")}function initMap(e,i){var n=Ti.App.Properties.getDouble("gps_lng",0),r=Ti.App.Properties.getDouble("gps_lat",0),t=i.createMapsforgeView({scalebar:!0,minZoom:5,maxZoom:20,centerLatlng:[r,n],zoomLevel:16,debug:!1});return e.add(t),e.open(),t}function addOfflineMapLayer(e){e.addLayer({name:"osm",path:"osmdroid/maps/nz/nz.map"})}function initNav(e){e.load("/osmdroid/maps/nz/")}function initMapListener(e,i,n){Ti.App.addEventListener("viewCreated",function(){Ti.API.info("mapCreated: received by js"),addOfflineMapLayer(n),addActionListeners(i,n),initGPS()})}function hidePopView(){var e=AllViews.pop;"undefined"!=typeof e&&e.hide()}function showPopView(){var e=AllViews.pop;"undefined"!=typeof e&&e.show()}function findDestMarker(){}function addMarker(e,i,n){var r=e.createMarker({iconPath:n,latlng:i});return r.id}function addNodeMarkers(){for(var e=getNodes(),i=JSON.parse(e),n=[],r=0;r<i.length;r++){var t=i[r].pts[0],a=[t[1],t[0]],o=Ti.App.Android.R.drawable.point_red,d=addMarker(map,a,o);n.push(d)}Ti.App.Properties.setString("RouteMarkers",JSON.stringify(n))}function removePrevLine(){var e=Ti.App.Properties.getInt("route");0!==e&&map.removeLayer(e)}function removePrevDestMarker(){0!==Ti.App.Properties.getInt("dest")&&map.removeLayer(Ti.App.Properties.getInt("dest"))}function removePrevNodeMarkers(){var e=Ti.App.Properties.getString("RouteMarkers");if(!(e.length<1))for(var i=JSON.parse(e),n=0;n<i.length;n++)map.removeLayer(i[n])}initVars();var win=initWindow();initWindowEvent(win);var mf=initModule(),map=initMap(win,mf);initMapListener(win,mf,map),initNav(mf),appEventListeners(),createAndroidSearchBar();