function getAddressGoogle(e,t,i){var o="https://maps.googleapis.com/maps/api/geocode/json?sensor=true&latlng="+e+","+t+"&key="+GOOGLE_API_KEY,a=Titanium.Network.createHTTPClient();a.open("GET",o),a.send(null),a.onload=function(){var e=JSON.parse(this.responseText);if("OK"==e.status){var t=getInfoFromGoogleJsonSimple(e.results[0].address_components);i&&i.call(null,t)}else Ti.API.error("getAddressGoogle:"+this.responseText)}}function getInfoFromGoogleJson(e){for(var t,i,o,a,r,n,s,l=0;l<e.length;l++)switch(e[l].types[0]){case"street_number":t=e[l].short_name,Ti.API.info("street number : "+t);break;case"route":i=e[l].long_name,Ti.API.info("street name : "+i);break;case"sublocality_level_1":o=e[l].long_name,Ti.API.info("area name : "+o);break;case"locality":a=e[l].long_name,Ti.API.info("city name : "+a);break;case"administrative_area_level_1":r=e[l].long_name,Ti.API.info("state name : "+r);break;case"postal_code":n=e[l].long_name,Ti.API.info("zip code : "+n);break;case"country":s=e[l].long_name,Ti.API.info("country name : "+s)}return"undefined"==typeof o?o="":o+=", ","undefined"==typeof t?t="":t+=" ",{number:t,street:i,area:o,city:a,state:r,zip:n,country:s}}function getInfoFromGoogleJsonSimple(e){for(var t=[],i=[],o=["administrative_area_level_2","administrative_area_level_1","postal_code","country"],a=0;a<e.length;a++){var r=o.indexOf(e[a].types[0])>-1;r?i.push(e[a].short_name):t.push(e[a].short_name)}return[t.join(", "),i.join()]}function searchAddressGoogle(e,t){var i="https://maps.google.com/maps/api/geocode/json?sensor=true&address="+e.replace(" ","+")+","+t+"&key="+GOOGLE_API_KEY,o=Ti.Network.createHTTPClient();o.setTimeout(1e4),o.onerror=function(e){Ti.API.error("searchAddressGoogle()Error:"+e)},o.onload=function(e){var t=JSON.parse(this.responseText);if("OK"==t.status&&void 0!=t.results&&t.results.length>0){for(var i=[],o=0;o<t.results.length;o++){var a={addr:"",point:""},r=t.results[o].geometry.location.lat,n=t.results[o].geometry.location.lng,s=getInfoFromGoogleJsonSimple(t.results[o].address_components);a.addr=s[0],a.point=[r,n],i.push(a)}createSuggestList(i,"Online")}else Ti.API.error("searchAddressGoogle()ServerError:"+this.responseText)},o.open("GET",i),o.setRequestHeader("Content-Type","application/json; charset=utf-8"),o.send()}var installOfflinePoiDB=function(){var e=Ti.Filesystem.externalStorageDirectory+"poi/nz.db";Ti.Database.install("nz",e)},searchOfflinePOI=function(e,t){var i=e.replace(/'/g,"''"),o=getCurrentPos(),a="poi",r="lat,lng,pname",n="pname match '*"+i+"*'",s=o[0]+"-lat",l=o[1]+"-lng",c="("+s+")*("+s+")+("+l+")*("+l+")  asc limit 0,20",d="select "+r+" from "+a+" where "+n+" order by "+c,p="/"+Ti.App.id+"/poi/"+t+".db",u={sql:d,db:p};navimodule.queryFTS(u,function(i){Ti.API.info("search records="+JSON.stringify(i.rows)),createSuggestList(i.rows,"Offline"),i.rows.length<1&&searchAddressGoogle(e,t)})},getAddressOSM=function(e,t,i){Ti.Geolocation.reverseGeocoder(e,t,function(e){i&&(Ti.API.info("reverse geolocation result = "+JSON.stringify(e.places[0].address)),i.call(null,e.places[0].address))})},getAddressCallback=function(e){AllViews.place_name1.text=e[0],AllViews.place_name2.text=e[1]};