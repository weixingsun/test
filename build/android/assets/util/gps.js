function handleLocation(e){if(!e.error){Ti.App.Properties.setDouble("lng",e.coords.longitude),Ti.App.Properties.setDouble("lat",e.coords.latitude),Ti.App.Properties.setInt("heading",e.coords.heading),Ti.App.Properties.setInt("accuracy",e.coords.accuracy),Ti.App.Properties.setInt("speed",e.coords.speed),0!==Ti.App.Properties.getInt("myCircle")&&map.removeLayer(Ti.App.Properties.getInt("myCircle")),0!==Ti.App.Properties.getInt("mySpot")&&map.removeLayer(Ti.App.Properties.getInt("mySpot"));var i=[e.coords.latitude,e.coords.longitude],r=map.createCircle({latlng:i,colorHex:"#440000FF",radius:e.coords.accuracy}),t=map.createMarker({iconPath:Ti.App.Android.R.drawable.me_point_blue_1,latlng:i});Ti.App.Properties.setInt("mySpot",t.id),Ti.App.Properties.setInt("myCircle",r.id)}}function addHandler(){locationAdded||(Ti.API.info("setup gps handler 2"),Ti.Geolocation.addEventListener("location",handleLocation),locationAdded=!0)}function removeHandler(){locationAdded&&(Ti.API.info("removeHandler gps"),Ti.Geolocation.removeEventListener("location",handleLocation),locationAdded=!1)}function initGPS(){Ti.Geolocation.accuracy=Ti.Geolocation.ACCURACY_BEST,Ti.Geolocation.distanceFilter=100,Ti.Geolocation.preferredProvider=Ti.Geolocation.PROVIDER_GPS,Ti.Geolocation.locationServicesEnabled?(Ti.API.info("setup gps handler 1"),addHandler()):alert("Please enable location services")}var locationAdded=!1;