function initNav(e){e.load(Ti.App.id+"/gh/nz/")}function getDestinatePos(){var e=Ti.App.Properties.getDouble("dest_lat",0),t=Ti.App.Properties.getDouble("dest_lng",0);return[e,t]}function setDestinatePos(e){Ti.App.Properties.setDouble("dest_lat",e[0]),Ti.App.Properties.setDouble("dest_lng",e[1])}function navi(e,t,i){ROUTING=!0;var o=Ti.App.Properties.getString("by"),a={vehicle:o,from:t,to:i};e.getRouteAsyncCallback(a,function(e){0==e.error?isGoogleMap()?drawGHonGMap(e):drawGHonMapsforge(e):Ti.API.info("navi error:"+e.errmsg),ROUTING=!1})}function drawGHonGMap(e){removePrevRoute();var t={id:"route",points:e.pts,color:"blue",width:10};addMyGooglePolyline(t),saveRouteInfo(e.nodes),addNodeMarkers(),setNaviMode(1),win.setKeepScreenOn(!0),setEmptyPlayedList(e.nodes)}function drawGHonMapsforge(e){removePrevRoute();var t=addPolylineMF(e.pts,"blue",10);savePolylineId(t),saveRouteInfo(e.nodes),addNodeMarkers(),setNaviMode(1),win.setKeepScreenOn(!0),setEmptyPlayedList(e.nodes)}function naviGoogle(e,t,i){var o=Ti.Network.createHTTPClient(),a="http://maps.googleapis.com/maps/api/directions/json?sensor=false&",r=a+"origin="+t[0]+","+t[1]+"&destination="+i[0]+","+i[1];Ti.API.info(r),o.open("GET",r),o.onload=function(){var t=JSON.parse(this.responseText);if(t.routes.length>0){var i=createRouteDataGoogle(t),o=e.createRoute({name:"navi",points:i,color:"red",width:10});Ti.API.info("googleRoute.onload:"+i.length),addGoogleRoute(o)}},o.send()}var ROUTING=!1,createRouteDataGoogle=function(e){var t,i=e.routes[0].overview_polyline.points,o=[],a=0,r=0;for(t=decodeLineGoogle(i),r=t.length,a=0;r>a;a+=1)null!=t[a]&&o.push({latitude:t[a][0],longitude:t[a][1]});return o},decodeLineGoogle=function(e){for(var t=e.length,i=0,o=[],a=0,r=0;t>i;){var n,s=0,l=0;do n=e.charCodeAt(i++)-63,l|=(31&n)<<s,s+=5;while(n>=32);var d=1&l?~(l>>1):l>>1;a+=d,s=0,l=0;do n=e.charCodeAt(i++)-63,l|=(31&n)<<s,s+=5;while(n>=32);var p=1&l?~(l>>1):l>>1;r+=p,o.push([1e-5*a,1e-5*r])}return o};