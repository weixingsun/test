function Places(){this.searchResult}Places.prototype.showAllSavedPlaceMarkers=function(e){this.deleteSavedPlaceMarkerDB("1=1");var t=this.selectAllPlacesDB();if(null!=t)for(var i=0;i<t.length;i++){var a=Ti.App.Android.R.drawable.star_red_24,o=[t[i].lat,t[i].lng],r=map.addMarker(o,a),n={lat:o[0],lng:o[1],id:r};this.addSavedPlaceMarkerDB(n)}},Places.prototype.isSavedPlacesDB=function(e){return null!==this.selectASavedPlaceDB(e)?!0:!1},Places.prototype.selectASavedPlaceMarkerDB=function(e){var t="saved_marker_id",i="lat,lng,id",a="lat='"+e[0]+"' and lng='"+e[1]+"'",o=this.selectDB("wx_map",t,i,a);return null!=o&&o.length>0?o[0]:null},Places.prototype.selectASavedPlaceDB=function(e){var t="saved_places",i="lat,lng,name",a="lat='"+e[0]+"' and lng='"+e[1]+"'",o=this.selectDB("wx_map",t,i,a);return null!=o&&o.length>0?o[0]:null},Places.prototype.selectAllPlacesDB=function(){var e="saved_places",t="lat,lng,name",i="1=1";return this.selectDB("wx_map",e,t,i)},Places.prototype.selectDB=function(e,t,i,a){var o,r=[],n=i.split(",");try{o=Ti.Database.open(e);var s="select "+i+" from "+t+" where "+a;Ti.API.info("selectDB="+s);var l=o.execute(s);if(l.rowCount<1)return null;for(;l.isValidRow();){for(var p={},d=0;d<n.length;d++)p[n[d]]=l.fieldByName(n[d]);r.push(p),l.next()}}finally{null!==l&&l.close(),null!==o&&o.close()}return r},Places.prototype.deleteSavedPlaceMarkerDB=function(e){this.deleteDB("saved_marker_id",e)},Places.prototype.removeSavedPlaceMarker=function(e){var t=this.selectASavedPlaceMarkerDB(e),i="lat='"+t.lat+"' and lng='"+t.lng+"'";this.deleteSavedPlaceMarkerDB(i),map.removeMarker(t.id)},Places.prototype.removeSavedPlaceDB=function(e){var t="lat='"+e.lat+"' and lng='"+e.lng+"'";this.deleteDB("saved_places",t)},Places.prototype.deleteDB=function(e,t){var i;try{i=Ti.Database.open("wx_map");var a="delete from "+e+" where "+t;i.execute(a)}finally{null!==i&&i.close()}},Places.prototype.addSavedPlaceMarkerDB=function(e){var t="saved_marker_id(lat,lng,id) values(?,?,?)",i=[e.lat,e.lng,e.id];this.insertDB(t,i)},Places.prototype.addSavedPlaceMarker=function(e){var t=Ti.App.Android.R.drawable.star_red_24,i=("saved_"+e[0]+"_"+e[1],map.addMarker(e,t)),a={lat:e[0],lng:e[1],id:i};this.addSavedPlaceMarkerDB(a)},Places.prototype.addSavedPlaceDB=function(e){var t="saved_places(lat,lng,name) values(?,?,?)",i=[e.lat,e.lng,e.name];this.insertDB(t,i)},Places.prototype.insertDB=function(e,t){var i;try{i=Ti.Database.open("wx_map"),i.execute("insert into "+e,t)}finally{null!==i&&i.close()}},Places.prototype.createSavedPlaceTable=function(){var e=Ti.Database.open("wx_map");e.execute("CREATE TABLE IF NOT EXISTS saved_places(lat varchar(20), lng varchar(20), name varchar(100));"),e.execute("CREATE TABLE IF NOT EXISTS saved_marker_id(lat varchar(20), lng varchar(20), id varchar(100));"),e.close()},Places.prototype.findSavedMarker=function(e){for(var t=Math.round(map.mapView.getZoomLevel()),i=this.getTapRange(t),a=this.selectAllPlacesDB(),o=0;o<a.length;o++){var r=a[o].lat,n=a[o].lng,s=distance(r,n,e[0],e[1]);if(i>s)return a[o]}return null},Places.prototype.getTapRange=function(e){switch(e){case 20:return 3;case 19:return 5;case 18:return 10;case 17:return 20;case 16:return 30;case 15:return 50;case 14:return 150;case 13:return 300;case 12:return 500;case 11:return 1e3;case 10:return 2e3;case 10:return 4e3;case 9:return 6e3;case 8:return 1e4;case 7:return 2e4;case 6:return 3e4;case 5:return 4e4;case 4:return 5e4}},Places.prototype.makePoiSql=function(e,t){var i=(e.replace(/'/g,"''"),map.getCurrentPos());i[0]+"-lat",i[1]+"-lng"},Places.prototype.searchOfflinePOI=function(e,t){var i=this.makePoiSql(e,t),a="/"+Ti.App.id+"/poi/"+t+".db",o={sql:i,db:a};map.navimodule.queryFTS(o,function(i){views.fillSearchList(i.rows,"Offline"),views.showSearchList(),i.rows.length<1&&net.searchNameAddressGoogle(e,t)})},Places.prototype.searchOfflineCctv=function(e){var t=this,i=.1,a="nz",o=" lat between "+(e[0]-i)+" and "+(e[0]+i),r=" and lng between "+(e[1]-i)+" and "+(e[1]-i),n="select lat,lng,speed from cctv where "+o+r,s="/"+Ti.App.id+"/poi/"+a+".db",l={sql:n,db:s};return map.navimodule.queryFTS(l,function(e){Ti.API.info("cctv search:"+JSON.stringify(e.rows)),t.searchResult=e}),null!=t.searchResult?t.searchResult:null};