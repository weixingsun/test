function initWindow(){return Ti.UI.createWindow()}function initWindowEvent(e){e.addEventListener("focus",function(){hideBar(e);createPlaceView()})}function hideBar(e){var i=e.activity.actionBar;"undefined"!=typeof i&&i.hide()}function initGoogleModule(){return require("ti.map")}function initGraphhopperModule(){return require("ti.mapsforge")}function initGoogleMap(e,i){var t=Ti.App.Properties.getDouble("gps_lng",0),a=Ti.App.Properties.getDouble("gps_lat",0),o=i.createView({userLocation:!0,mapType:i.NORMAL_TYPE,region:{latitude:a,longitude:t,latitudeDelta:.1,longitudeDelta:.1},height:"100%",width:"100%",top:0,left:0});return addGmapActionListeners(o),e.add(o),e.open(),o}function addGmapActionListeners(e){e.addEventListener("click",function(e){var i=e.longitude,t=e.latitude;Ti.API.info("map.clicked:"+t+","+i)}),e.addEventListener("longclick",function(i){removeMyGoogleMarker("dest"),removeMyGooglePolyline("navi");var t=[i.latitude,i.longitude],a=getCurrentPos();addMyGoogleMarker("dest",t[0],t[1],Ti.App.Android.R.drawable.marker_tap,!1),navi(graph,e,a,t)}),e.addEventListener("complete",function(){Ti.API.info("map load complete"),createAndroidSearchBar()})}function addMyGoogleMarker(e,i,t,a,o){{var n={latitude:i,longitude:t,id:e,image:a,draggable:o};map.addMarker(n)}}function removeMyGoogleMarker(e){map.removeMarker(e)}function addMyGooglePolyline(e){map.addPolyline(e)}function removeMyGooglePolyline(e){map.removePolyline(e)}function move(e){map.setLocation({latitude:e[0],longitude:e[1]})}function animateTo(e){var i=map.getRegion();i.latitude=e[0],i.longitude=e[1],map.setLocation(i)}function setTraffic(e){map.setTrafficEnabled(e)}function setGoogleMapType(e){map.setMapType(e)}function getFitZoomMapRegionWithCoords(e){for(var i=-90,t=180,a=90,o=-180,n=0;n<e.length;n++){var l=e[n];t=Math.min(t,parseFloat(l.longitude)),i=Math.max(i,parseFloat(l.latitude)),o=Math.max(o,parseFloat(l.longitude)),a=Math.min(a,parseFloat(l.latitude))}var r=i-.5*(i-a),d=t+.5*(o-t),u=1.1*Math.abs(i-a),p=1.1*Math.abs(o-t);0==u&&0==p&&(u=p=.01);var s={latitude:r,longitude:d,latitudeDelta:u,longitudeDelta:p};return s}var map_type="google.normal";initVars(map_type);var win=initWindow();initWindowEvent(win);var module=initGoogleModule(),graph=initGraphhopperModule(),map=initGoogleMap(win,module);initNav(graph),initGPS();